<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Radhe Krishna Japa Sadhana - Voice-guided mantra chanting with speech recognition">
    <meta name="keywords" content="japa, sadhana, radhe krishna, mantra, meditation, chanting">
    <meta name="author" content="Sadguru Seva Platform">
    <title>üôè ‡§ú‡§™ ‡§∏‡§æ‡§ß‡§®‡§æ | Radhe Krishna Japa Sadhana</title>

    <!-- CSS Files -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/japa.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Favicon and Icons -->
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <link rel="apple-touch-icon" href="{{ url_for('static', filename='apple-touch-icon.png') }}">

    <!-- Meta tags for PWA -->
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Japa Sadhana">

    <style>
        /* Additional styles for repetition display */
        .repetition-indicator {
            display: inline-block;
            background: rgba(102, 126, 234, 0.2);
            color: #667eea;
            font-size: 0.8rem;
            padding: 2px 6px;
            border-radius: 10px;
            margin-left: 5px;
            font-weight: 600;
        }

        .mantra-word.repeated {
            position: relative;
        }

        .mantra-word.repeated::after {
            content: attr(data-rep-count);
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ff6b9d;
            color: white;
            font-size: 0.7rem;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .pattern-guide {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }

        .pattern-guide h4 {
            color: #fff;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .pattern-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .pattern-item:last-child {
            border-bottom: none;
        }

        .pattern-word {
            font-size: 1.1rem;
            color: #fff;
            font-weight: 600;
        }

        .pattern-count {
            background: #4CAF50;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.9rem;
            font-weight: bold;
        }
    </style>
</head>
<body>
<div class="container">
    <!-- Header -->
    <header class="header">
        <h1 class="title">üôè ‡§ú‡§™ ‡§∏‡§æ‡§ß‡§®‡§æ</h1>
        <p class="subtitle">‡§∞‡§æ‡§ß‡•á ‡§ï‡•É‡§∑‡•ç‡§£‡§æ ‡§Æ‡§Ç‡§§‡•ç‡§∞ ‡§ú‡§™ - Voice Guided Chanting</p>
    </header>

    <!-- Stats Section -->
    <div class="stats-container">
        <div class="stat-card" title="‡§ú‡§™ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ">
            <div class="stat-number" id="dailyWords">{{ daily_words or 0 }}</div>
            <div class="stat-label">‡§Ü‡§ú‡§ö‡•Ä ‡§ú‡§™ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ</div>
        </div>
        <div class="stat-card" title="‡§™‡•Å‡§∞‡•ç‡§£ ‡§ï‡•á‡§≤‡•á‡§≤‡•á ‡§∞‡§æ‡§â‡§Ç‡§°">
            <div class="stat-number" id="dailyRounds">{{ daily_rounds or 0 }}</div>
            <div class="stat-label">‡§Ü‡§ú‡§ö‡•á ‡§∞‡§æ‡§â‡§Ç‡§°</div>
        </div>
        <div class="stat-card" title="‡§π‡•ç‡§Ø‡§æ ‡§∏‡§§‡•ç‡§∞‡§æ‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§ï‡•á‡§≤‡•á‡§≤‡•Ä ‡§ú‡§™ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ">
            <div class="stat-number" id="sessionCount">{{ current_count or 0 }}</div>
            <div class="stat-label">‡§∏‡§§‡•ç‡§∞‡§æ‡§§‡•Ä‡§≤ ‡§ú‡§™</div>
        </div>
        {% if lifetime_rounds is defined and lifetime_words is defined %}
        <div class="stat-card" title="‡§™‡•Å‡§∞‡•ç‡§£ ‡§ú‡§ø‡§µ‡§® ‡§™‡•ç‡§∞‡§µ‡§æ‡§∏‡§æ‡§§‡•Ä‡§≤ ‡§∞‡§æ‡§â‡§Ç‡§°">
            <div class="stat-number" id="lifetimeRounds">{{ lifetime_rounds or 0 }}</div>
            <div class="stat-label">‡§™‡•Å‡§∞‡•ç‡§£ ‡§∞‡§æ‡§â‡§Ç‡§°</div>
        </div>
        <div class="stat-card" title="‡§™‡•Å‡§∞‡•ç‡§£ ‡§ú‡§ø‡§µ‡§® ‡§™‡•ç‡§∞‡§µ‡§æ‡§∏‡§æ‡§§‡•Ä‡§≤ ‡§ú‡§™ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ">
            <div class="stat-number" id="lifetimeWords">{{ lifetime_words or 0 }}</div>
            <div class="stat-label">‡§™‡•Å‡§∞‡•ç‡§£ ‡§ú‡§™</div>
        </div>
        {% endif %}
    </div>

    <!-- Main Japa Area -->
    <div class="japa-container">
        <!-- Current Expected Word Display -->
        <div class="current-word-display">
            <h3>‡§Ö‡§ó‡§≤‡§æ ‡§∂‡§¨‡•ç‡§¶ ‡§¨‡•ã‡§≤‡•á‡§Ç:</h3>
            <div class="expected-word" id="expectedWord">
                {% if mantra_words and (1 <= current_word_index <= mantra_words|length) %}
                    <span class="devanagari" id="expectedDevanagari" role="main">
                        {{ mantra_words[current_word_index - 1].word_devanagari }}
                    </span>
                    <span class="english" id="expectedEnglish" role="complementary">
                        ({{ mantra_words[current_word_index - 1].word_english }})
                        {% if mantra_words[current_word_index - 1].total_repetitions > 1 %}
                            <span class="repetition-indicator">
                                [{{ mantra_words[current_word_index - 1].repetition_number or 1 }}/{{ mantra_words[current_word_index - 1].total_repetitions }}]
                            </span>
                        {% endif %}
                    </span>
                {% else %}
                    <span class="devanagari" id="expectedDevanagari" role="main">‡§∞‡§æ‡§ß‡•á</span>
                    <span class="english" id="expectedEnglish" role="complementary">(radhe)</span>
                {% endif %}
            </div>
            <div class="word-progress" role="status" aria-live="polite">
                <span id="wordProgress">{{ current_word_index or 1 }}/{{ mantra_words|length if mantra_words else 16 }}</span>
            </div>
        </div>

        <!-- Full Mantra Display -->
        <div class="mantra-box" id="mantraBox" role="region" aria-label="‡§™‡•Ç‡§∞‡§æ ‡§Æ‡§Ç‡§§‡•ç‡§∞">
            <div class="mantra-text" id="mantraText">
                {% if mantra_words %}
                    {% for word in mantra_words %}
                        <span class="mantra-word{% if word.total_repetitions > 1 %} repeated{% endif %}"
                              data-word-order="{{ word.word_order }}"
                              data-word-english="{{ word.word_english }}"
                              data-word-devanagari="{{ word.word_devanagari }}"
                              {% if word.total_repetitions > 1 %}
                              data-rep-count="{{ word.total_repetitions }}"
                              {% endif %}
                              title="{{ word.word_english }}{% if word.total_repetitions > 1 %} ({{ word.repetition_number }}/{{ word.total_repetitions }}){% endif %}"
                              tabindex="0">
                            {{ word.word_devanagari }}
                        </span>
                    {% endfor %}
                {% else %}
                    <span class="mantra-word" data-word-order="1" data-word-english="radhe" title="radhe">‡§∞‡§æ‡§ß‡•á</span>
                    <span class="mantra-word" data-word-order="2" data-word-english="krishna" title="krishna">‡§ï‡•É‡§∑‡•ç‡§£‡§æ</span>
                    <span class="mantra-word" data-word-order="3" data-word-english="shyam" title="shyam">‡§∂‡•ç‡§Ø‡§æ‡§Æ</span>
                    <span class="mantra-word" data-word-order="4" data-word-english="shama" title="shama">‡§∂‡§æ‡§Æ‡§æ</span>
                {% endif %}
            </div>
        </div>

        <!-- Voice Controls -->
        <div class="controls-container" role="region" aria-label="‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§£">
            <button class="voice-btn" id="startBtn"
                    title="‡§ú‡§™‡§æ‡§≤‡§æ ‡§∏‡•Å‡§∞‡§µ‡§æ‡§§ ‡§ï‡§∞‡§æ ‡§∏‡•ç‡§™‡•á‡§∏ ‡§¶‡§æ‡§¨‡§æ"
                    aria-label="‡§ú‡§™ ‡§∏‡•Å‡§∞‡§µ‡§æ‡§§ ‡§ï‡§∞‡§æ">
                <div class="mic-icon" aria-hidden="true">üé§</div>
                <span>‡§ú‡§™ ‡§∏‡•Å‡§∞‡•Å‡§µ‡§æ‡§§ ‡§ï‡§∞‡§æ</span>
            </button>
            <button class="voice-btn stop-btn" id="stopBtn"
                    style="display:none;"
                    title="‡§ú‡§™‡§æ‡§≤‡§æ ‡§•‡§æ‡§Ç‡§¨‡§µ‡§æ (Escape ‡§¶‡§æ‡§¨‡§æ)"
                    aria-label="‡§ú‡§™‡§æ‡§≤‡§æ ‡§•‡§æ‡§Ç‡§¨‡§µ‡§æ">
                <div class="stop-icon" aria-hidden="true">‚èπ</div>
                <span>‡§ú‡§™ ‡§•‡§æ‡§Ç‡§¨‡§µ‡§æ</span>
            </button>

            <div class="voice-status" id="voiceStatus" role="status" aria-live="polite">
                ‡§Æ‡§æ‡§á‡§ï‡•ç‡§∞‡•ã‡§´‡•ã‡§® ‡§§‡§Ø‡§æ‡§∞ ‡§Ü‡§π‡•á‡•§ ‡§∏‡•Å‡§∞‡•Å‡§µ‡§æ‡§§ ‡§ï‡§∞‡§£‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä ‡§¨‡§ü‡§® ‡§¶‡§æ‡§¨‡§æ
            </div>
            
            <form id="logoutForm" style="text-align: right; margin-top: 20px;">
                <button type="submit" class="btn btn-outline-danger" style="font-size: 1.2rem; padding: 10px 20px;">üö™ ‡§∏‡§§‡•ç‡§∞ ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç</button>
            </form>

            <script>
            document.getElementById('logoutForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                const response = await fetch('/auth/japa/logout', { method: 'POST' });
                const result = await response.json();
                if (result.success) {
                    window.location.href = '/auth';
                }
            });
            </script>

            <div class="recognition-feedback" id="recognitionFeedback"
                 style="display:none;" role="alert" aria-live="assertive">
            </div>
        </div>

        <!-- Progress Ring -->
        <div class="progress-container">
            <div class="progress-ring" id="counterRing" role="progressbar"
                 aria-valuenow="{{ current_word_index or 1 }}"
                 aria-valuemin="1"
                 aria-valuemax="{{ mantra_words|length if mantra_words else 16 }}"
                 aria-label="‡§Æ‡§Ç‡§§‡•ç‡§∞ ‡§™‡•ç‡§∞‡§ó‡§§‡§ø">
                <div class="progress-text">
                    <span class="progress-number" id="progressNumber">{{ current_word_index or 1 }}</span>
                    <span class="progress-label">/ {{ mantra_words|length if mantra_words else 16 }}</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Pattern Guide -->
    <div class="pattern-guide" role="region" aria-labelledby="pattern-heading">
        <h4 id="pattern-heading">üîÑ ‡§Æ‡§Ç‡§§‡•ç‡§∞ ‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§ó‡§æ‡§á‡§°:</h4>
        <div class="pattern-item">
            <span class="pattern-word">‡§∞‡§æ‡§ß‡•á (Radhe)</span>
            <span class="pattern-count">1x</span>
        </div>
        <div class="pattern-item">
            <span class="pattern-word">‡§ï‡•É‡§∑‡•ç‡§£‡§æ (Krishna)</span>
            <span class="pattern-count">1x</span>
        </div>
        <div class="pattern-item">
            <span class="pattern-word">‡§∞‡§æ‡§ß‡•á (Radhe)</span>
            <span class="pattern-count">1x</span>
        </div>
        <div class="pattern-item">
            <span class="pattern-word">‡§ï‡•É‡§∑‡•ç‡§£‡§æ (Krishna)</span>
            <span class="pattern-count">3x</span>
        </div>
        <div class="pattern-item">
            <span class="pattern-word">‡§∞‡§æ‡§ß‡•á (Radhe)</span>
            <span class="pattern-count">3x</span>
        </div>
        <div class="pattern-item">
            <span class="pattern-word">‡§∂‡•ç‡§Ø‡§æ‡§Æ (Shyam)</span>
            <span class="pattern-count">1x</span>
        </div>
        <div class="pattern-item">
            <span class="pattern-word">‡§∞‡§æ‡§ß‡•á (Radhe)</span>
            <span class="pattern-count">1x</span>
        </div>
        <div class="pattern-item">
            <span class="pattern-word">‡§∂‡§æ‡§Æ‡§æ (Shama)</span>
            <span class="pattern-count">1x</span>
        </div>
        <div class="pattern-item">
            <span class="pattern-word">‡§∂‡•ç‡§Ø‡§æ‡§Æ (Shyam)</span>
            <span class="pattern-count">1x</span>
        </div>
        <div class="pattern-item">
            <span class="pattern-word">‡§∂‡§æ‡§Æ‡§æ (Shama)</span>
            <span class="pattern-count">1x</span>
        </div>
        <div class="pattern-item">
            <span class="pattern-word">‡§∞‡§æ‡§ß‡•á (Radhe)</span>
            <span class="pattern-count">2x</span>
        </div>
        <div style="text-align: center; margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.2);">
            <strong style="color: #4CAF50;">‡§ï‡•Å‡§≤: 16 ‡§â‡§ö‡•ç‡§ö‡§æ‡§∞‡§£ ‡§™‡•ç‡§∞‡§§‡§ø ‡§∞‡§æ‡§â‡§Ç‡§°</strong>
        </div>
    </div>

    <!-- Instructions -->
    <div class="instructions" role="region" aria-labelledby="instructions-heading">
        <h3 id="instructions-heading">üìã ‡§â‡§™‡§Ø‡•ã‡§ó ‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂:</h3>
        <ul>
            <li>‡§Æ‡§æ‡§á‡§ï ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§Ç ‡§î‡§∞ "‡§ú‡§™ ‡§™‡•ç‡§∞‡§æ‡§∞‡§Ç‡§≠ ‡§ï‡§∞‡•á‡§Ç" ‡§¨‡§ü‡§® ‡§¶‡§¨‡§æ‡§è‡§Ç</li>
            <li>‡§ä‡§™‡§∞ ‡§¶‡§ø‡§ñ‡§æ‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§∂‡§¨‡•ç‡§¶ ‡§∏‡•ç‡§™‡§∑‡•ç‡§ü ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§¨‡•ã‡§≤‡•á‡§Ç (‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§Ø‡§æ ‡§Ö‡§Ç‡§ó‡•ç‡§∞‡•á‡§ú‡•Ä ‡§Æ‡•á‡§Ç)</li>
            <li>‡§∏‡§π‡•Ä ‡§∂‡§¨‡•ç‡§¶ ‡§¨‡•ã‡§≤‡§®‡•á ‡§™‡§∞ ‡§Ö‡§ó‡§≤‡§æ ‡§∂‡§¨‡•ç‡§¶ ‡§¶‡§ø‡§ñ‡•á‡§ó‡§æ</li>
            <li>‡§Æ‡§Ç‡§§‡•ç‡§∞ ‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§ï‡•á ‡§Ö‡§®‡•Å‡§∏‡§æ‡§∞ ‡§∂‡§¨‡•ç‡§¶‡•ã‡§Ç ‡§ï‡•ã ‡§®‡§ø‡§∞‡•ç‡§¶‡§ø‡§∑‡•ç‡§ü ‡§¨‡§æ‡§∞ ‡§¶‡•ã‡§π‡§∞‡§æ‡§è‡§Ç</li>
            <li>16 ‡§â‡§ö‡•ç‡§ö‡§æ‡§∞‡§£ ‡§™‡•Ç‡§∞‡•á ‡§π‡•ã‡§®‡•á ‡§™‡§∞ ‡§è‡§ï ‡§∞‡§æ‡§â‡§Ç‡§° ‡§™‡•Ç‡§∞‡§æ ‡§π‡•ã‡§ó‡§æ</li>
            <li>‡§¨‡•á‡§π‡§§‡§∞ ‡§™‡§π‡§ö‡§æ‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∂‡§æ‡§Ç‡§§ ‡§µ‡§æ‡§§‡§æ‡§µ‡§∞‡§£ ‡§Æ‡•á‡§Ç ‡§¨‡•ã‡§≤‡•á‡§Ç</li>
            <li>‡§ï‡•Ä‡§¨‡•ã‡§∞‡•ç‡§° ‡§∂‡•â‡§∞‡•ç‡§ü‡§ï‡§ü: ‡§∏‡•ç‡§™‡•á‡§∏‡§¨‡§æ‡§∞ (‡§∂‡•Å‡§∞‡•Ç), Escape (‡§∞‡•ã‡§ï‡•á‡§Ç)</li>
        </ul>
    </div>

    <!-- Pronunciation Guide -->
    <div class="instructions" style="margin-top: 20px;" role="region" aria-labelledby="pronunciation-heading">
        <h3 id="pronunciation-heading">üó£Ô∏è ‡§â‡§ö‡•ç‡§ö‡§æ‡§∞‡§£ ‡§ó‡§æ‡§á‡§°:</h3>
        <ul>
            <li><strong>‡§∞‡§æ‡§ß‡•á</strong> - "Radhe", "Radhe", "‡§∞‡§æ‡§ß‡•á‡§Ø" ‡§ï‡§π‡•á‡§Ç</li>
            <li><strong>‡§ï‡•É‡§∑‡•ç‡§£‡§æ</strong> - "Krishna", "Krishna", "‡§ï‡•É‡§∑‡•ç‡§£‡§æ" ‡§ï‡§π‡•á‡§Ç</li>
            <li><strong>‡§∂‡•ç‡§Ø‡§æ‡§Æ</strong> - "Shyam", "Shyam", "‡§∂‡•ç‡§Ø‡§æ‡§Æ" ‡§ï‡§π‡•á‡§Ç</li>
            <li><strong>‡§∂‡§æ‡§Æ‡§æ</strong> - "Shama", "Shama", "‡§∂‡§æ‡§Æ‡§æ" ‡§ï‡§π‡•á‡§Ç</li>
        </ul>
    </div>

    <!-- System Status -->
    <div class="instructions" style="margin-top: 20px; text-align: center;" role="region" aria-labelledby="system-status">
        <h3 id="system-status">‚ö° ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§∏‡•ç‡§•‡§ø‡§§‡§ø:</h3>
        <div style="display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; margin-top: 15px;">
            <div style="display: flex; align-items: center; gap: 8px;">
                <span id="micStatus">üé§</span>
                <span id="micStatusText">‡§Æ‡§æ‡§á‡§ï ‡§§‡•à‡§Ø‡§æ‡§∞</span>
            </div>
            <div style="display: flex; align-items: center; gap: 8px;">
                <span id="networkStatus">üåê</span>
                <span id="networkStatusText">‡§ë‡§®‡§≤‡§æ‡§á‡§®</span>
            </div>
            <div style="display: flex; align-items: center; gap: 8px;">
                <span id="speechStatus">üó£Ô∏è</span>
                <span id="speechStatusText">‡§µ‡•â‡§á‡§∏ ‡§∞‡§ø‡§ï‡§ó‡•ç‡§®‡§ø‡§∂‡§® ‡§§‡•à‡§Ø‡§æ‡§∞</span>
            </div>
        </div>
    </div>

    <!-- Error Display -->
    {% if error %}
    <div class="error-message" role="alert">
        ‚ùå ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: {{ error }}
        <br><small>‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•á‡§ú ‡§ï‡•ã ‡§∞‡§ø‡§´‡•ç‡§∞‡•á‡§∂ ‡§ï‡§∞‡•á‡§Ç ‡§Ø‡§æ ‡§§‡§ï‡§®‡•Ä‡§ï‡•Ä ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§≤‡•á‡§Ç</small>
    </div>
    {% endif %}

    <!-- Hidden data for JavaScript -->
    <script type="application/json" id="mantraWordsData">
        {{ mantra_words | tojson | safe }}
    </script>

    <!-- Additional metadata for JavaScript -->
    <script type="application/json" id="configData">
        {
            "totalWords": {{ mantra_words|length if mantra_words else 16 }},
            "currentWordIndex": {{ current_word_index or 1 }},
            "sessionCount": {{ current_count or 0 }},
            "dailyStats": {
                "words": {{ daily_words or 0 }},
                "rounds": {{ daily_rounds or 0 }}
            },
            "lifetimeStats": {
                "words": {{ lifetime_words or 0 }},
                "rounds": {{ lifetime_rounds or 0 }}
            },
            "supportedLanguages": ["hi-IN", "en-IN", "en-US"],
            "version": "2.1.0",
            "patternBased": true
        }
    </script>
</div>

<!-- Loading overlay -->
<div id="loadingOverlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 9999; align-items: center; justify-content: center; color: white; font-size: 1.5rem;">
    <div>
        <div style="width: 50px; height: 50px; border: 3px solid transparent; border-top: 3px solid #fff; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 20px;"></div>
        <div>‡§™‡•ç‡§∞‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£ ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</div>
    </div>
</div>

<!-- JavaScript -->
<script src="{{ url_for('static', filename='js/japa.js') }}"></script>

<!-- Service Worker for offline capability (optional) -->
<script>
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/sw.js').catch(err => {
            console.log('ServiceWorker registration failed: ', err);
        });
    }

    // Update system status indicators
    function updateSystemStatus() {
        // Network status
        const networkStatus = document.getElementById('networkStatus');
        const networkStatusText = document.getElementById('networkStatusText');
        if (navigator.onLine) {
            networkStatus.textContent = 'üü¢';
            networkStatusText.textContent = '‡§ë‡§®‡§≤‡§æ‡§á‡§®';
        } else {
            networkStatus.textContent = 'üî¥';
            networkStatusText.textContent = '‡§ë‡§´‡§≤‡§æ‡§á‡§®';
        }

        // Speech recognition status
        const speechStatus = document.getElementById('speechStatus');
        const speechStatusText = document.getElementById('speechStatusText');
        if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
            speechStatus.textContent = '‚úÖ';
            speechStatusText.textContent = '‡§µ‡•â‡§á‡§∏ ‡§∞‡§ø‡§ï‡§ó‡•ç‡§®‡§ø‡§∂‡§® ‡§â‡§™‡§≤‡§¨‡•ç‡§ß';
        } else {
            speechStatus.textContent = '‚ùå';
            speechStatusText.textContent = '‡§µ‡•â‡§á‡§∏ ‡§∞‡§ø‡§ï‡§ó‡•ç‡§®‡§ø‡§∂‡§® ‡§Ö‡§®‡•Å‡§™‡§≤‡§¨‡•ç‡§ß';
        }
    }

    // Update status on load and network changes
    document.addEventListener('DOMContentLoaded', updateSystemStatus);
    window.addEventListener('online', updateSystemStatus);
    window.addEventListener('offline', updateSystemStatus);

    // Add loading animation styles
    const style = document.createElement('style');
    style.textContent = `
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    `;
    document.head.appendChild(style);
</script>
</body>
</html>
