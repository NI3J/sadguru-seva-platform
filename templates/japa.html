<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>рдЬрдк рд╕рд╛рдзрдирд╛ | Japa Sadhana</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/japa.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1 class="title">ЁЯЩП рдЬрдк рд╕рд╛рдзрдирд╛</h1>
            <p class="subtitle">рд░рд╛рдзреЗ рдХреГрд╖реНрдгрд╛ рдордВрддреНрд░ рдЬрдк</p>
        </header>

        <!-- Stats Section -->
        <div class="stats-container">
            <div class="stat-card">
                <div class="stat-number" id="dailyWords">{{ daily_words }}</div>
                <div class="stat-label">рдЖрдЬ рдХреЗ рд╢рдмреНрдж</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="dailyRounds">{{ daily_rounds }}</div>
                <div class="stat-label">рдЖрдЬ рдХреЗ рд░рд╛рдЙрдВрдб</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="sessionCount">{{ current_count }}</div>
                <div class="stat-label">рд╕рддреНрд░ рдореЗрдВ рд╢рдмреНрдж</div>
            </div>
        </div>

        <!-- Main Japa Area -->
        <div class="japa-container">
            <!-- Current Expected Word Display -->
            <div class="current-word-display">
                <h3>рдЕрдЧрд▓рд╛ рд╢рдмреНрдж:</h3>
                <div class="expected-word" id="expectedWord">
                    <span class="devanagari" id="expectedDevanagari">
                        {% if mantra_words and current_word_index <= mantra_words|length %}
                            {{ mantra_words[current_word_index - 1]['word_devanagari'] }}
                        {% else %}
                            рд░рд╛рдзреЗ
                        {% endif %}
                    </span>
                    <span class="english" id="expectedEnglish">
                        {% if mantra_words and current_word_index <= mantra_words|length %}
                            ({{ mantra_words[current_word_index - 1]['word_english'] }})
                        {% else %}
                            (radhe)
                        {% endif %}
                    </span>
                </div>
                <div class="word-progress">
                    <span id="wordProgress">{{ current_word_index }}/16</span>
                </div>
            </div>

            <!-- Full Mantra Display -->
            <div class="mantra-box" id="mantraBox">
                <div class="mantra-text" id="mantraText">
                    {% for word in mantra_words %}
                        <span class="mantra-word" data-word-order="{{ word.word_order }}">{{ word.word_devanagari }}</span>
                    {% endfor %}
                </div>
            </div>

            <!-- Voice Controls -->
            <div class="controls-container">
                <button class="voice-btn" id="startBtn">
                    <div class="mic-icon">ЁЯОд</div>
                    <span>рдЬрдк рдкреНрд░рд╛рд░рдВрдн рдХрд░реЗрдВ</span>
                </button>
                
                <button class="voice-btn stop-btn" id="stopBtn" style="display: none;">
                    <div class="stop-icon">тП╣</div>
                    <span>рдЬрдк рд░реЛрдХреЗрдВ</span>
                </button>

                <div class="voice-status" id="voiceStatus">
                    рдорд╛рдЗрдХреНрд░реЛрдлреЛрди рддреИрдпрд╛рд░ рд╣реИ
                </div>
                
                <div class="recognition-feedback" id="recognitionFeedback" style="display: none;">
                    <!-- Shows what was heard and whether it matched -->
                </div>
            </div>

            <!-- Progress Ring -->
            <div class="progress-container">
                <div class="progress-ring">
                    <div class="progress-text">
                        <span class="progress-number" id="progressNumber">{{ current_word_index }}</span>
                        <span class="progress-label">/ 16</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Instructions -->
        <div class="instructions">
            <h3>ЁЯУЛ рдирд┐рд░реНрджреЗрд╢:</h3>
            <ul>
                <li>рдКрдкрд░ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╢рдмреНрдж рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдмреЛрд▓реЗрдВ</li>
                <li>рд╕рд╣реА рд╢рдмреНрдж рдмреЛрд▓рдиреЗ рдкрд░ рдЕрдЧрд▓рд╛ рд╢рдмреНрдж рджрд┐рдЦреЗрдЧрд╛</li>
                <li>16 рд╢рдмреНрдж рдкреВрд░реЗ рд╣реЛрдиреЗ рдкрд░ рдПрдХ рд░рд╛рдЙрдВрдб рдкреВрд░рд╛ рд╣реЛрдЧрд╛</li>
                <li>рдорд╛рдЗрдХ рдХреЗ рдкрд╛рд╕ рд╕реНрдкрд╖реНрдЯ рдЙрдЪреНрдЪрд╛рд░рдг рдХрд░реЗрдВ</li>
                <li>рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП 'рдЬрдк рдкреНрд░рд╛рд░рдВрдн рдХрд░реЗрдВ' рджрдмрд╛рдПрдВ</li>
            </ul>
        </div>

        <!-- Error Display -->
        {% if error %}
        <div class="error-message">
            тЭМ {{ error }}
        </div>
        {% endif %}

        <!-- Hidden data for JavaScript -->
        <script type="application/json" id="mantraWordsData">
            {{ mantra_words | tojson }}
        </script>
    </div>

    <script src="{{ url_for('static', filename='js/japa.js') }}"></script>
</body>
</html>
